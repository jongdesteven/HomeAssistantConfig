- platform: huesensor

- platform: time_date
  display_options:
    - 'time'

- platform: mqtt
  state_topic: "raspi/temp"
  name: "Raspi Temperature"
  unit_of_measurement: "°C"
  icon: 'mdi:oil-temperature'
  value_template: '{{ value_json.temperature }}'

- platform: mqtt
  state_topic: "home/doorbell/ringer/time"
  name: "Doorbell Ring Time"
  unit_of_measurement: "ms"
- platform: mqtt
  state_topic: "home/bbq/update"
  value_template: "{{ value_json.p2 }}"
  name: "BBQ Sensor 2"
  availability_topic: "home/bbq/status"
  unit_of_measurement: "°C"
  icon: mdi:thermometer


- platform: template
  sensors:
    energieverbruik_totaal:
      entity_id: sensor.energieverbruik_totaal_hoog, sensor.energieverbruik_totaal_laag
      value_template: >
        {{ (states.sensor.energieverbruik_totaal_hoog.state|float + states.sensor.energieverbruik_totaal_laag.state|float) | round(2) }}
      unit_of_measurement: 'kWh'
- platform: template
  sensors:
    energieverbruik_per_uur:
      entity_id: sensor.energieverbruik_totaal_hoog, sensor.energieverbruik_totaal_laag
      value_template: >
        {{ (states.sensor.energieverbruik_totaal.state|float - states.input_number.power_usage_previous_hour.state|float) | round(2) }}
      unit_of_measurement: 'kWh'
- platform: template
  sensors:
    gasverbruik_per_uur:
      value_template: >
        {{ (states.sensor.gasverbruik_totaal.state|float - states.input_number.gas_usage_previous_hour.state|float) | round(2) }}
      unit_of_measurement: 'm3'
- platform: template
  sensors:
    energieverbruik_per_dag:
      entity_id: sensor.energieverbruik_totaal_hoog, sensor.energieverbruik_totaal_laag
      value_template: >
        {{ (states.sensor.energieverbruik_totaal.state|float - states.input_number.power_usage_previous_day.state|float) | round(2) }}
      unit_of_measurement: 'kWh'
- platform: template
  sensors:
    gasverbruik_per_dag:
      entity_id: sensor.gasverbruik_totaal
      value_template: >
        {{ (states.sensor.gasverbruik_totaal.state|float - states.input_number.gas_usage_previous_day.state|float) | round(2) }}
      unit_of_measurement: 'm3'

- platform: mqtt
  state_topic: "home/smartmeter/electricity_tariff"
  name: "Energie Tarief"
  icon: 'mdi:theme-light-dark'
- platform: mqtt
  state_topic: "home/smartmeter/power_delivered"
  name: "Energieverbruik Actueel"
  value_template: "{{ (float(value) * 1000) | int }}"
  icon: 'mdi:power-plug'
  unit_of_measurement: "W"
- platform: mqtt
  state_topic: "home/smartmeter/water_delivered"
  name: "Gasverbruik Totaal"
  icon: 'mdi:fire'
  unit_of_measurement: "m3"
- platform: mqtt
  state_topic: "home/smartmeter/energy_delivered_tariff1"
  name: "Energieverbruik Totaal Laag"
  icon: 'mdi:power-plug'
  unit_of_measurement: "kWh"
- platform: mqtt
  state_topic: "home/smartmeter/energy_delivered_tariff2"
  name: "Energieverbruik Totaal Hoog"
  icon: 'mdi:power-plug'
  unit_of_measurement: "kWh"

- platform: mqtt
  state_topic: "home/smartmeter/power_delivered_l1"
  name: "Energieverbruik Actueel L1"
  value_template: "{{ (float(value) * 1000) | int }}"
  icon: 'mdi:power-plug'
  unit_of_measurement: "W"
- platform: mqtt
  state_topic: "home/smartmeter/power_delivered_l2"
  name: "Energieverbruik Actueel L2"
  value_template: "{{ (float(value) * 1000) | int }}"
  icon: 'mdi:power-plug'
  unit_of_measurement: "W"
- platform: mqtt
  state_topic: "home/smartmeter/power_delivered_l3"
  name: "Energieverbruik Actueel L3"
  value_template: "{{ (float(value) * 1000) | int }}"
  icon: 'mdi:power-plug'
  unit_of_measurement: "W"

- platform: mqtt
  state_topic: "home/smartmeter/voltage_l1"
  name: "Spanning L1"
  icon: 'mdi:power-plug'
  unit_of_measurement: "V"
- platform: mqtt
  state_topic: "home/smartmeter/voltage_l2"
  name: "Spanning L2"
  icon: 'mdi:power-plug'
  unit_of_measurement: "V"
- platform: mqtt
  state_topic: "home/smartmeter/voltage_l3"
  name: "Spanning L3"
  icon: 'mdi:power-plug'
  unit_of_measurement: "V"

- platform: mqtt
  state_topic: "home/sonoff_oven/tele/SENSOR"
  name: "Oven Power Today"
  value_template: '{{ value_json["ENERGY"]["Today"] }}'
  icon: 'mdi:baguette'
  unit_of_measurement: "KWh"
- platform: mqtt
  state_topic: "home/sonoff_oven/tele/SENSOR"
  name: "Oven Power Now"
  value_template: '{{ value_json["ENERGY"]["Power"] }}'
  icon: 'mdi:baguette'
  unit_of_measurement: "W"

- platform: mqtt
  state_topic: "home/sonoff_pomp/tele/SENSOR"
  name: "Water pump Power Now"
  value_template: '{{ value_json["ENERGY"]["Power"] }}'
  icon: 'mdi:flash'
  unit_of_measurement: "W"
- platform: mqtt
  state_topic: "home/sonoff_pomp/tele/SENSOR"
  name: "Water pump Power Today"
  value_template: '{{ value_json["ENERGY"]["Today"] }}'
  icon: 'mdi:flash'
  unit_of_measurement: "KWh"

- platform: template
  sensors:
    alarm_clock_time:
      friendly_name: 'Alarm Time'
      icon_template: 'mdi:alarm'
      value_template: '{{ "%0.02d:%0.02d" | format(states.input_number.alarm_clock_hour.state | int, states.input_number.alarm_clock_minute.state | int ) }}'
    alarm_clock_fade_in_minutes:
      friendly_name: 'Fade In (Minutes)'
      icon_template: 'mdi:gradient'
      value_template: '{{ states.input_number.alarm_clock_fade_in_minutes.state | int }}'
    doorbell_last_press:
      friendly_name: 'Last Doorbell Press'
      entity_id:  binary_sensor.doorbell
      icon_template: 'mdi:clock-alert'
      value_template: '{{ as_timestamp(states.binary_sensor.doorbell.last_changed) | timestamp_custom("%a %d %b %H:%M") }}'
    overloop_lux_level:
      friendly_name: 'Overloop Lux Level'
      entity_id: binary_sensor.overloop_motion_sensor
      icon_template: 'mdi:white-balance-sunny'
      unit_of_measurement: 'lx'
      value_template: '{{ states.binary_sensor.overloop_motion_sensor.attributes.lx | float }}'
    overloop_light_level:
      friendly_name: 'Overloop Light Level'
      entity_id: binary_sensor.overloop_motion_sensor
      icon_template: 'mdi:white-balance-sunny'
      unit_of_measurement: 'll'
      value_template: '{{ states.binary_sensor.overloop_motion_sensor.attributes.light_level | int }}'
    overloop_temperature:
      friendly_name: 'Overloop Sensor Temperature'
      entity_id: binary_sensor.overloop_motion_sensor
      icon_template: 'mdi:temperature-celsius'
      value_template: '{{ states.binary_sensor.overloop_motion_sensor.attributes.temperature | float }}'
      unit_of_measurement: "°C"
    bbq_meat_set_temp:
      friendly_name: 'BBQ Meat Set Temperature'
      unit_of_measurement: "°C"
      value_template: '{{ states.input_number.bbq_meat_set_temp.state | int }}'
    bbq_dome_set_temp:
      friendly_name: 'BBQ Dome Set Temperature'
      unit_of_measurement: "°C"
      value_template: '{{ states.input_number.bbq_dome_set_temp.state | int }}'

- platform: rflink
  automatic_add: false

- platform: buienradar
  name: !secret weather_name
  monitored_conditions:
    - stationname
    - conditioncode
    - condition
    - conditiondetailed
    - conditionexact
    - symbol
    - humidity
    - temperature
    - groundtemperature
    - windspeed
    - windforce
    - winddirection
    - windazimuth
    - pressure
    - visibility
    - windgust
    - precipitation
    - irradiance
    - precipitation_forecast_average
    - precipitation_forecast_total

- platform: afvalbeheer
  wastecollector: Waalre
  resources:
    - restafval
    - gft
    - papier
    - pbd
  postcode: 5581TL
  streetnumber: 15
