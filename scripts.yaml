sonos_say:
  alias: "Sonos TTS script"
  sequence:
   - service: media_player.sonos_snapshot
     data_template:
       entity_id: "{{ sonos_entity }}"
   - service: media_player.sonos_unjoin
     data_template:
       entity_id: "{{ sonos_entity }}"
   - service: media_player.volume_set
     data_template:
       entity_id: "{{ sonos_entity }}"
       volume_level: "{{ volume }}"
   - service: tts.google_say
     data_template:
       entity_id: "{{ sonos_entity }}"
       message: "{{ message }}"
   - delay: "{{ delay }}"
   - service: media_player.sonos_restore
     data_template:
       entity_id: "{{ sonos_entity }}"

tv_lift_up:
  alias: "TV Lift Up Script"
  sequence:
    - service: switch.turn_on
      entity_id: switch.tv_lift_up
    - service: switch.turn_off
      entity_id: switch.tv_lift_down
#    - service: media_player.apple_tv_press_buttons
#      entity_id: media_player.apple_tv
#      buttons: top_menu
tv_lift_down:
  alias: "TV Lift Down Script"
  sequence:
    - service: switch.turn_on
      entity_id: switch.tv_lift_down
    - service: switch.turn_off
      entity_id: switch.tv_lift_up
#    - service: media_player.apple_tv_press_buttons
#      entity_id: media_player.apple_tv
#      buttons: top_menu, top_menu, select

early_heating:
  alias: "Pre-heat the house"
  sequence:
    - service: notify.ios_iphone_steven
      data_template:
        message: "Het is nu {{ states.sensor.woonkamer_temperature.state | float }}Â°C. \n {{ ( ( 20.0 - ( states.sensor.woonkamer_temperature.state | float ) ) * 60.0 ) | int }} min togo"
        title: "Het is koud thuis"
    - delay:
        minutes: 120
      #- delay: >
      #{% if ( ( 20.0 - ( states.sensor.woonkamer_temperature.state | float ) ) * 60.0 ) | int <= 180 %}
      #  {% if {{ 120 <= 180 }} %}
      #    minutes: {{ 180 - ( ( ( 20.0 - ( states.sensor.woonkamer_temperature.state | float ) ) * 60.0 ) | int ) }}
      #  {% else %}
      #    seconds: 10
      #  {% endif %}
    - service: climate.set_temperature
      entity_id: climate.woonkamer 
      data:
        temperature: 20
        operation_mode: Manual

lights_during_day:
  alias: Turn on Lights during day
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.woonkamer
        brightness: 75
        kelvin: 2700
    - service: light.turn_on
      data:
        entity_id: light.lamp_keukeneiland
        brightness: 75
        kelvin: 2700
    - service: light.turn_on
      data:
        entity_id: light.keuken
        brightness: 35
        kelvin: 2700

woonkamerverlichting_avond:
  alias: Woonkamer lampen avond
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.woonkamer
        brightness: 25
        kelvin: 2500
    - service: light.turn_on
      data:
        entity_id: light.lamp_keukeneiland
        brightness: 10
        kelvin: 2500
    - service: light.turn_on
      data:
        entity_id: light.keuken
        brightness: 5
        kelvin: 2500

verlichting_niet_thuis:
  alias: Woonkamer lampen afwezig
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.bank_kamer, light.livingcolors_1
        brightness: 50
        kelvin: 2700
    - service: light.turn_on
      data:
        entity_id: light.lamp_keukeneiland
        brightness: 5
        kelvin: 2700
    - service: light.turn_on
      data:
        entity_id: light.keuken
        brightness: 5
        kelvin: 2500

#Zigbee2MQTT
zigbee2mqtt_rename:
  alias: Zigbee2mqtt Rename
  sequence:
    service: mqtt.publish
    data_template:
      topic: zigbee2mqtt/bridge/config/rename
      payload_template: >-
        {
          "old": "{{ states.input_text.zigbee2mqtt_old_name.state | string }}",
          "new": "{{ states.input_text.zigbee2mqtt_new_name.state | string }}"
        }
zigbee2mqtt_remove:
  alias: Zigbee2mqtt Remove
  sequence:
    service: mqtt.publish
    data_template:
      topic: zigbee2mqtt/bridge/config/remove
      payload_template: "{{ states.input_text.zigbee2mqtt_remove.state | string }}"


#Lights brightness loop
light_slaapkamer_brightness_change:
  alias: Lights brightness change down
  sequence:
    repeat:
      sequence:
        - delay:
          #milliseconds: 200
            milliseconds: "{{ speed_ms }}"
        - service: light.turn_on
          data:
            entity_id: light.slaapkamer
            #brightness_step_pct: 10
            brightness_step_pct: "{{ step_pct }}"
      while:
        - condition: state
          entity_id: input_boolean.slaapkamer_light_change
          state: 'on'
          #- condition: template
          #template: '{{ repeat.index <= 25 }}' #safeguard
