- id: automation_1
  alias: 'Diner Lights'
#  hide_entity: False
# initial_state: "off"
  trigger:
    platform: state
    entity_id: input_boolean.diner_lights
    to: 'on'
  action:
  - service: light.hue_activate_scene
    data:
      group_name: 'Woonkamer'
      scene_name: 'Diner'
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.diner_lights

- id: automation_2
  alias: 'Avond Lights'
#  hide_entity: False
# initial_state: "off"
  trigger:
    platform: state
    entity_id: input_boolean.avond_lights
    to: 'on'
  action:
  - service: light.hue_activate_scene
    data:
      group_name: 'Woonkamer'
      scene_name: 'Avond'
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.avond_lights

- id: automation_3
  alias: 'Alarm On'
  trigger:
    platform: state
    entity_id: input_boolean.alarm_toggle
    to: 'on'
  action:
  - service: media_player.volume_set
    data:
      entity_id: media_player.family_room
      volume_level: 0.13
#  - service: media_player.select_source
#    data:
#      entity_id: media_player.family_room
#      source: "Peaceful Piano"
  - service: media_player.play_media
    data:
      entity_id: media_player.family_room
      media_content_id: "spotify:user:spotify:playlist:37i9dQZF1DX4sWSpwq3LiO"
      media_content_type: "playlist"

#  - service: script.sonos_say
#    data:
#      sonos_entity: media_player.family_room
#      volume: 0.5
#      message: 'Alarm button is pressed!'
#      delay: '00:00:05'

- id: automation_4
  alias: 'Doorbell pressed'
  trigger:
    platform: state
    entity_id: binary_sensor.doorbell
    to: 'on'
  action:
  - service: notify.all_iphones
    data:
      message: "Doorbell pressed"
      data:
        push:
          sound: "doorbell-sound-effect.wav"
  - condition: state
    entity_id: light.trap_spot
    state: 'off'    
  - service: light.turn_on
    data:
      entity_id: light.trap_spot
      brightness: 63
      color_temp: 330
  - delay: 00:05:00
  - service: light.turn_off
    entity_id: light.trap_spot

- id: automation_5
  alias: 'Doorbell Ringer off during night'
  trigger:
    platform: time
    at: '22:00:00'
  action:
  - service: switch.turn_off
    entity_id: switch.doorbell_ringer

- id: automation_5a
  alias: 'Doorbell Ringer on during day'
  trigger:
    platform: time
    at: '06:00:00'
  action:
    - service: switch.turn_on
      entity_id: switch.doorbell_ringer

- id: automation_6a
  alias: 'Carport lights on at sunset'
  trigger:
    platform: sun
    event: sunset
  action:
    - service: light.turn_on
      data:
        entity_id: light.carport
        brightness: 63 
        color_temp: 330
- id: automation_6b
  alias: 'Carport lights off at sunrise'
  trigger:
    platform: sun
    event: sunrise
  action:
    - service: light.turn_off
      entity_id: light.carport

- id: automation_7
  alias: 'Alarm clock fade in lights'
  trigger:
    platform: time
    minutes: '/1'
    seconds: 00
  condition:
    condition: and
    conditions:
      - condition: template
        value_template: '{{ now().strftime("%H:%M") == states.sensor.alarm_clock_time.state }}'
      - condition: or
        conditions:
          - condition: and
            conditions:
              - condition: state
                entity_id: input_boolean.alarm_clock_status
                state: 'on'
              - condition: time
                weekday:
                  - mon
                  - tue
                  - wed
                  - thu
                  - fri
          - condition: and
            conditions:
              - condition: state
                entity_id: input_boolean.alarm_clock_weekend_status
                state: 'on'
              - condition: time
                weekday:
                  - sat
                  - sun
  action:
    - service: light.turn_on
      data_template:
        entity_id: light.slaapkamer
        transition: '{{ states.sensor.alarm_clock_fade_in_minutes.state | int * 60 }}'
        profile: energize

- id: automation_8
  alias: 'Set Sonos Alarm Weekday'
  trigger:
    - platform: state
      entity_id: input_boolean.alarm_clock_status
      to: 'on'
  action:
    - service: media_player.sonos_update_alarm
      data_template:
        entity_id: media_player.bedroom
        alarm_id: 3
        time: '{{ states.sensor.alarm_clock_time.state }}'
        enabled: true
- id: automation_8a
  alias: 'Set Sonos Alarm Weekend'
  trigger:
    - platform: state
      entity_id: input_boolean.alarm_clock_weekend_status
      to: 'on'
  action:
    - service: media_player.sonos_update_alarm
      data_template:
        entity_id: media_player.bedroom
        alarm_id: 61
        time: '{{ states.sensor.alarm_clock_time.state }}'
        enabled: true

- id: automation_9
  alias: 'Disable Sonos Alarm Weekdays'
  trigger:
    - platform: state
      entity_id: input_boolean.alarm_clock_status
      to: 'off'
  action:
    - service: media_player.sonos_update_alarm
      data_template:
        entity_id: media_player.bedroom
        alarm_id: 3
        enabled: false
- id: automation_9a
  alias: 'Disable Sonos Alarm Weekend'
  trigger:
    - platform: state
      entity_id: input_boolean.alarm_clock_weekend_status
      to: 'off'
  action:
    - service: media_player.sonos_update_alarm
      data_template:
        entity_id: media_player.bedroom
        alarm_id: 61
        enabled: false
    
- id: automation_10
  alias: 'Change Alarm Clock time'
  trigger:
    - platform: state
      entity_id: sensor.alarm_clock_time
  action:
    - service: media_player.sonos_update_alarm
      data_template:
        entity_id: media_player.bedroom
        alarm_id: 3
        time: '{{ states.sensor.alarm_clock_time.state }}'  
    - service: media_player.sonos_update_alarm
      data_template:
        entity_id: media_player.bedroom
        alarm_id: 61
        time: '{{ states.sensor.alarm_clock_time.state }}'  

- id: automation_11
  alias: 'All indoor lights off when holding buttons'
  trigger:
    - platform: state
      entity_id: sensor.slaapkamer_dimmer_switch_2, sensor.woonkamer_dimmer_switch_1
      to: '4_hold'
  action:
    - service: light.turn_off
      entity_id:
        - light.slaapkamer
        - light.woonkamer
        - light.overloop
        - light.tuinkamer
- id: automation_12
  alias: 'All indoor lights bright on when holding buttons'
  trigger:
    - platform: state
      entity_id: sensor.slaapkamer_dimmer_switch_2, sensor.woonkamer_dimmer_switch_1
      to: '1_hold'
  action:
    - service: light.turn_on
      entity_id:
        - light.slaapkamer
        - light.woonkamer
        - light.overloop
        - light.tuinkamer
      data:
        brightness: 254
        color_temp: 200

- id: automation_13a
  alias: 'All indoor lights off when leaving the house'
  trigger:
    platform: state
    entity_id: group.family
    to: 'not_home'
  condition:
    condition: sun
    after: sunrise
  action:
    - service: light.turn_off
      entity_id:
        - light.slaapkamer
        - light.woonkamer
        - light.overloop
        - light.tuinkamer
- id: automation_13b
  alias: 'Woonkamer on  when coming home after dark'
  trigger:
    platform: state
    entity_id: group.family
    to: 'home'
  condition:
    condition: sun
    after: sunset
  action:
    - service: light.hue_activate_scene
      data:
        group_name: 'Woonkamer'
        scene_name: 'Avond'
- id: automation_13c
  alias: 'Woonkamer on after dark when not home'
  trigger:
    platform: sun
    event: sunset
  condition:
    condition: state
    entity_id: group.family
    state: 'not_home'
  action:
    - service: light.turn_on
      entity_id:
        - light.bank_kamer
      data:
        brightness: 50
        color_temp: 366
- id: automation_13d
  alias: 'All off on sunrise when not home'
  trigger:
    platform: sun
    event: sunrise
    offset: "00:30:00"
  condition:
    condition: state
    entity_id: group.family
    state: 'not_home'
  action:
    - service: light.turn_off
      entity_id:
        - light.slaapkamer
        - light.woonkamer
        - light.overloop
        - light.tuinkamer
